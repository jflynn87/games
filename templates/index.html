{% extends 'base.html' %}
{% load static %}

<style>
    :root {
        --primary-color: #0d6efd;
        --secondary-color: #6c757d;
        --background-color: #f8f9fa;
        --card-bg-start: #f9fafb;
        --card-bg-end: #e9ecef;
        --border-color: #e3e6ea;
        --shadow-light: rgba(0, 0, 0, 0.04);
        --shadow-hover: rgba(0, 0, 0, 0.25);
    }

    body {
        background-color: var(--background-color);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    }

    .container.py-4 {
        background: #fff;
        border-radius: 1rem;
        box-shadow: 0 2px 8px var(--shadow-light);
        padding: 2rem;
    }
/* 
.card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
} */


    .card-img-top {
        object-fit: cover;
        width: 100%;
        height: 12rem; /* Consistent image height */
        border-bottom: 1px solid var(--border-color);
    }
    
    .card-header {
        background-color: transparent;
        border-bottom: 0;
        text-align: center;
        font-weight: 600;
        font-size: 1.5rem;
        padding-top: 1.5rem;
    }

    .card-title {
        font-size: 1.3rem;
        font-weight: bold;
        margin-bottom: 1rem;
    }
    
    .card-body {
        padding-top: 1rem;
        padding-bottom: 1.5rem;
    }
</style>

{% block body_block %}
<div class="container pt-3" id="main_container">
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4 justify-content-center">
        <div class="col-12 col-lg-3 mb-4">
            <div class="card h-100 w-100 shadow rounded-3 border-1">
                <div>
                    <h3 class="card-header">‚õ≥Ô∏è Golf Game</h3>
                    <img src="{% static 'img/IMG_4425.jpg' %}" class="card-img-top" alt="Golf Game" style="height: 200px; ">
                </div>
                <div class="card-body d-grid gap-2">
                    <a href="{% url 'golf_app:new_field_list_1' %}" class="btn btn-primary">Make Picks</a>
                    {% if t.pga_tournament_num == '468'%}
                        <a href="{% url 'golf_app:ryder_cup_scores' %}" class="btn btn-primary">Ryder Cup Scores</a>
                    {% else %}
                        <a href="{% url 'golf_app:api_scores_view' %}" class="btn btn-primary">Current Week Scores</a>
                    {% endif %}
                    <a href="{% url 'golf_app:total_score' %}" class="btn btn-primary">Season Totals</a>
                    <a href="{% url 'golf_app:all_time' %}" class="btn btn-primary">All Time Stats</a>
                    <a href="{% url 'golf_app:about' %}" class="btn btn-primary">About</a>
                </div>
            </div>
        </div>
        <div class="col-12 col-lg-3 mb-4">
            <div class="card h-100 w-100 shadow rounded-3 border-1">
                <div>
                    <h3 class="card-header">üìä Golf Leaderboard</h3>
                    <img src="{% static '/img/Masters-leaderboard.gif' %}" class="card-img-top" alt="Golf Leaderboard" style="height: 200px">
                </div>
                <script type="text/javascript"> </script>
                <div id='golf_lb_body' class="card-body"></div>
            </div>
        </div>
        <div class="col-12 col-lg-3 mb-4">
            <div class="card h-100 w-100 shadow rounded-3 border-1">
                <div>
                    <h3 class="card-header">üèà Football Game</h3>
                    <img src="{% static '/img/SBTrophy1050.jpg' %}" class="card-img-top" alt="Football Game" style="height: 200px">
                </div>
                <div class="card-body d-grid gap-2">
                    <a href="{% url 'fb_app:games_list' pk=fb_week.pk %}" class="btn btn-primary">Make Picks</a>
                    <a href="{% url 'fb_app:scores_list' %}" class="btn btn-primary">Current Week Scores</a>
                    <a href="{% url 'fb_app:season_total' %}" class="btn btn-primary">Season Totals</a>
                    <a href="{% url 'fb_app:analytics' %}" class="btn btn-primary">Analytics</a>
                    <a href="{% url 'fb_app:about' %}" class="btn btn-primary">About</a>
                    {% if game %}
                        {% if picks %}
                            <a href="{% url 'fb_app:playoff_entry' pk=picks.pk %}" class="btn btn-primary">Update Super Bowl</a>
                        {% else %}
                            <a href="{% url 'fb_app:playoff_entry' %}" class="btn btn-primary">Super Bowl Picks</a>
                        {% endif %}
                        <a href="{% url 'fb_app:playoff_score' %}" class="btn btn-primary">Super Bowl Score</a>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-12 col-lg-3 mb-4">
            <div class="card h-100 w-100 shadow rounded-3 border-1">
                <div>
                    <h3 class="card-header">üìä FB Leaderboard</h3>
                    <img src="{% static '/img/fb_lb.jpg' %}" class="card-img-top" alt="Football Leaderboard" style="height: 200px">
                </div>
                <div id='fb_lb_body' class='card-body'></div>
            </div>
        </div>
        {% if event %}
        <div class="col-12 col-lg-3 mb-4">
            <div class="card h-100 w-100 shadow rounded-3 border-1">
                <div>
                    <h3 class="card-header">‚öΩÔ∏è {{event.name}}</h3>
                    <img src="{% get_static_prefix %}{{event.logo_file}}" class="card-img-top" alt="{{ event.name }}">
                </div>
                <div class="card-body d-grid gap-2">
                    <a href="{% url 'wc_app:wc_group_picks' %}" class="btn btn-primary">Group Stage Picks</a>
                    <a href="{% url 'wc_app:wc_ko_picks_view' %}" class="btn btn-primary">Knockout Stage Picks</a>
                    <a href="{% url 'wc_app:wc_scores' %}" class="btn btn-primary">Scores</a>
                    <a href="{% url 'wc_app:wc_about' %}" class="btn btn-primary">About</a>
                </div>
            </div>
        </div>
        {% endif %}
        
    </div>
        {% if user.is_superuser %}
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4 justify-content-center">
        <div class="col-12 col-lg-3 mb-4">
            <div class="card h-100 w-100 shadow rounded-3 border-0">
                <div>
                    <h3 class="card-header">üõ†Ô∏è Admin Menu</h3>
                </div>
                <div class="card-body d-grid gap-2">
                    <a href="{% url 'run_app:dashboard' %}" class="btn btn-primary">Runs</a>
                    <a href="{% url 'golf_app:setup' %}" class="btn btn-primary">Golf Setup</a>
                    <a href="{% url 'port_app:add_position' %}" class="btn btn-primary">Portfolio</a>
                    <a href="{% url 'admin:index' %}" class="btn btn-primary">Admin</a>
                    <a href="{% url 'golf_app:update_field' %}" class="btn btn-primary">Update Field</a>
                    <a href="{% url 'fb_app:setup' %}" class="btn btn-primary">Setup NFL</a>
                </div>
            </div>
        </div>            
        <div class="col-12 col-lg-3 mb-4">
            <div id="baseball_scores" class="card h-100 w-100 shadow rounded-3 border-0">
                <h3 class="card-header">‚öæÔ∏è Baseball Scores</h3>
                <div class="card-body"></div>
            </div>
        </div>
        <div class="col-12 col-lg-3 mb-4">
        <div id="run_stats" class="card h-100 w-100 shadow rounded-3 border-0">

                <h3 class="card-header">üèÉ‚Äç‚ôÇÔ∏è Run Stats</h3>
                <div class="card-body">
                    <div id="shoe_stats">
                        <p id="shoe_update">Loading...</p>
                    </div>
                    <div id="run_plan_summary"></div>
                    <div id="this_week_run_plan"></div>
                </div>
            </div>
        </div>
        
    </div>
    {% endif %}

</div>

<p hidden id='username'>{{ request.user.username }}</p>
<p hidden id='tournament_key'>{{ t.pk }}</p>


{% load compress %}

{% compress js %}
<script src='{% static "golf_app/js/leaderboard.js"%}' type="text/javascript" ></script>
<script src='{% static "fb_app/js/leaderboard.js" %}' type="text/javascript"></script>
<script src='{% static "run_app/js/update_stats.js" %}' type="text/javascript"></script>
<script src='{% static "run_app/js/run_plan_summary.js" %}' type="text/javascript"></script>
<script src='{% static "run_app/js/this_week_run_plan.js" %}' type="text/javascript"></script>
{% endcompress %}

<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
        // Initializing Leaderboards
        update_lb();
        update_fb_lb();

        // Loading Baseball Scores (Admin only)
        if (document.getElementById('username').innerText === '{{ user.username }}' && document.getElementById('tournament_key').innerText) {
            fetch("/user_app/baseball_scores/", { method: "GET" })
                .then(response => response.json())
                .then(data => {
                    if (Object.keys(data).length !== 0) {
                        let tableHtml = `<table class="table" id="baseball_table">
                                            <thead>
                                                <tr>
                                                    <th>Final</th>
                                                    <th>Inning</th>
                                                    <th>Team</th>
                                                    <th>Score</th>
                                                    <th>Team</th>
                                                    <th>Score</th>
                                                </tr>
                                            </thead>
                                            <tbody>`;

                        for (const gameId in data) {
                            const game = data[gameId];
                            const teams = Object.keys(game).filter(key => key.startsWith('team'));
                            const team1 = game[teams[0]];
                            const team2 = game[teams[1]];
                            const team1Bold = team1.winner ? 'font-weight: bold;' : '';
                            const team2Bold = team2.winner ? 'font-weight: bold;' : '';

                            tableHtml += `<tr id="${gameId}">
                                            <td>${game.final}</td>
                                            <td>${game.inning}</td>
                                            <td style="${team1Bold}">${team1.name}</td>
                                            <td>${team1.score}</td>
                                            <td style="${team2Bold}">${team2.name}</td>
                                            <td>${team2.score}</td>
                                        </tr>`;
                        }

                        tableHtml += `</tbody></table>
                                      <p class="mt-3"><a href="https://mlb.primotact.com" target="_blank" class="btn btn-link">MLB Game</a></p>`;

                        const baseballScoresDiv = document.getElementById('baseball_scores');
                        if (baseballScoresDiv) {
                            baseballScoresDiv.querySelector('.card-body').innerHTML = tableHtml;
                            baseballScoresDiv.hidden = false;
                        }
                    }
                })
                .catch(error => console.error('Error fetching baseball scores:', error));
        }

        // Loading Run Stats (Admin only)
        if (document.getElementById('username').innerText === '{{ user.username }}' && document.getElementById('tournament_key').innerText) {
            updateRunData().then(() => {
                runPlanSummary();
                thisWeekRunPlan();
            });
        }
    });
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
        card.addEventListener('mouseenter', () => {
            card.style.transform = 'translateY(-10px)';
            card.style.boxShadow = '0 10px 20px rgba(0, 0, 0, 0.2)';
        });
        card.addEventListener('mouseleave', () => {
            card.style.transform = 'none';
            card.style.boxShadow = 'none';
        });
    });
});
</script>

{% endblock %}